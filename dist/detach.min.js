!function(t,e){"use strict";"function"==typeof define&&define.amd?define("Detach",[],function(){return e()}):"object"==typeof exports?module.exports.Detach=e():t.Detach=e()}("undefined"!=typeof window?window:this,function(){function t(t,e){if("/"===e.charAt(0))return location.protocol+"//"+location.host+e;var n=/^\.\//gi,o="",r=[],i=[],c=[],a=!1;return"/"===t.charAt(0)&&(a=!0),t=t.replace(n,""),e=e.replace(n,""),(r=t.split("/")).pop(),(i=e.split("/")).forEach(function(t,e){".."===t&&(r.pop(),i[e]="")}),r.concat(i).forEach(function(t,e){""!==t&&c.push(t)}),o=c.join("/").replace(/\/{2,}/gi,"/"),a?"/"+o:o}function e(t){return Array.prototype.slice.call(t)}function n(t){var n=document.createElement("div");return n.innerHTML=t,e(n.children)}function o(t){("[object Array]"===Object.prototype.toString.call(t)?e(t):t).forEach(function(t){t.style.setProperty("display","none")})}function r(e){var r=e.tpl,s=e.container||document.body,u=e.data||{},l=e.onReady||function(){};!function(t,e){var n=XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");n.open("GET",t+"?"+(new Date).getTime(),!0),n.onload=function(){if(200!==n.status&&206!==n.status&&304!==n.status)throw new Error("load template error");e(n.responseText)},n.onerror=function(){throw new Error("ajax error")},n.send()}(r,function(e){var r=null,d=null,p=null,f=null,h=document.documentElement.querySelector("head"),m=document.body,y=[],v=[];d=n(e.replace(/((<link[\s\S]*?\/?>)|(<style[\s\S]*?>[\s\S]*?<\/style>))/gi,function(e,n){o=e;if(/(<link[\s\S]*?\/?>)/gi.test(e))var o=function(e){var n=e.match(/<link.*href=['|"]([^'"]*)['|"]/i)[1],o=t(i.tpl,n);return e.replace(n,o)}(e);return y.push(o),""}).replace(/(<script[\s\S]*?>[\s\S]*?<\/script>)/gi,function(t){return v.push(t),""}).replace(/\{\{([\s\S]*?)\}\}/gi,function(t,e){return void 0===u[e]?"":u[e]})),p=n(y.join("")),f=n(v.join("")),r=document.createDocumentFragment(),p.forEach(function(t){t.classList.add(c),r.appendChild(t)}),h.appendChild(r),o(d),r=document.createDocumentFragment(),d.forEach(function(t){t.classList.add(a),t.classList.add(c),r.appendChild(t)}),s.appendChild(r),l(),setTimeout(function(){r=document.createDocumentFragment(),function(e){var n=[],o=i.tpl;return e.forEach(function(e){var r=document.createElement("script"),i=e.getAttribute("src");r.type="text/javascript",i?(r.src=t(o,i),n.push(r)):(r.innerHTML=e.innerHTML,n.push(r))}),n}(f).forEach(function(t){t.classList.add(c),r.appendChild(t)}),m.appendChild(r)})})}var i=function(){this.cList={},this.dList=[],this.tList={},this.db={}},c="",a="";return i.prototype.init=function(t){i.self=this,i.tpl=t.tpl;var e=(new Date).getTime();this.cList[t.name]=void 0===t.controller?function(){}:t.controller,this.tList[t.name]=c="detach_"+e,this.dList[t.name]=a="dom_"+e,r(t)},i.prototype.destroy=function(t){e(document.querySelectorAll("."+this.tList[t.name])).forEach(function(t){t.parentNode.removeChild(t)}),delete this.cList[t.name],delete this.dList[t.name],delete this.tList[t.name]},i.prototype.router={push:function(t){var n=i.self.dList[t.name];if(n){!function(t){e(t).forEach(function(t){t.style.removeProperty("display","none")})}(e(document.querySelectorAll("."+n))),i.self.cList[t.name]()}},delete:function(t){var n=i.self.dList[t.name];if(n){var r=e(document.querySelectorAll("."+n));r&&o(r)}}},i.prototype.sub=function(t,e){this.db[t]=e},i.prototype.pub=function(t,e){var n=this.db[t];void 0!==n&&n(e)},new i});